/**
 * SwivelJS v2.0.0 - 2018-05-16
 * Strategy driven, segmented feature toggles
 *
 * Copyright (c) 2018 Zumba&reg;
 * Licensed MIT
 */

(function(o){"use strict";Array.prototype.reduce||(Array.prototype.reduce=function(e){if(null===this||this===o)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var t,r=Object(this),n=r.length>>>0,i=0;if(2===arguments.length)t=arguments[1];else{for(;i<n&&!(i in r);)i++;if(n<=i)throw new TypeError("Reduce of empty array with no initial value");t=r[i++]}for(;i<n;i++)i in r&&(t=e(t,r[i],i,r));return t});var f=".",e=Array.prototype.reduce,a=Object.prototype.toString,r=function(e,t){this.slug=e,this.strategy=t};r.prototype.execute=function(e){return this.strategy.apply(null,e||[])};var i=function(e,t){this.featureMap=e,this.index=t};i.prototype.enabled=function(e){return this.featureMap.enabled(e.slug,this.index)};var u=function(e,t){this.behavior=e||null,this.args=t||[]},t=function(e,t){this.slug=e,this.bucket=t,this.waived=!1,u.call(this)},n="__swivel_default",l=t.prototype;l.addBehavior=function(e,t,r){var n=this.getBehavior(e,t);return this.bucket.enabled(n)&&u.call(this,n,r),this},l.addValue=function(e,t){var r=this.getBehavior(e,function(){return t});return this.bucket.enabled(r)&&u.call(this,r),this},l.defaultBehavior=function(e,t){if(this.waived)throw"Defined a default behavior after `noDefault` was called.";return this.behavior||u.call(this,this.getBehavior(e),t),this},l.defaultValue=function(e){if(this.waived)throw"Defined a default value after `noDefault` was called.";if(!this.behavior){u.call(this,this.getBehavior(function(){return e}))}return this},l.execute=function(){return(this.behavior||this.getBehavior(function(){return null})).execute(this.args||[])},l.getBehavior=function(e,t){if(t===o&&(t=e,e=n),"function"!=typeof t)throw"Invalid callable passed to Builder.getBehavior().";return new r(this.slug+f+e,t)},l.noDefault=function(){var e=this.behavior;if(e&&e.slug===n)throw"Called `noDefault` after a default behavior was defined.";return this.waived=!0,this};var s=function(e,t){return e|1<<--t},h=function(e){this.map=function(e){var t,r,n,i={};for(t in e)e.hasOwnProperty(t)&&(r=e[t],i[t]=(n=r,"[object Array]"===a.call(n)?r.reduce(s,0):r));return i}(e)},c=h.prototype,d=function(e,t){var r,n,i=t.map;for(r in i)i.hasOwnProperty(r)&&(n=i[r],e[r]=e[r]?e[r]|n:n);return e};c.add=function(){return new h(e.call(arguments,d,this.map))},c.diff=function(e){var t,r=this.map,n=e.map,i={};for(t in n)!n.hasOwnProperty(t)||r[t]!==o&&r[t]===n[t]||(i[t]=n[t]);for(t in r)r.hasOwnProperty(t)&&n[t]===o&&(i[t]=r[t]);return new h(i)},c.enabled=function(e,t){var r,n=this.map,i="",o=e.split(f),a=o.length,u=0;for(t=1<<t-1;u<a;u++)if(r=o[u],!(n[i+=i?f+r:r]&&n[i]&t))return!1;return!0},c.intersect=function(e){var t,r=this.map,n=e.map,i={};for(t in n)n.hasOwnProperty(t)&&r[t]===n[t]&&(i[t]=n[t]);return new h(i)};var p=function(e,t){var r,n=t.map;for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);return e};c.merge=function(){return new h(e.call(arguments,p,this.map))};var v=function e(t){if(!(this instanceof e))return new e(t);t||(t={});var r=t.map||{},n=r instanceof h?r:new h(r);this.bucket=new i(n,t.bucketIndex)},w=v.prototype;w.forFeature=function(e){return new t(e,this.bucket)},w.invoke=function(e,t,r){var n=e.split(f);return this.forFeature(n.shift()).addBehavior(n.join(f),t).defaultBehavior(r).execute()},w.returnValue=function(e,t,r){var n=e.split(f);return this.forFeature(n.shift()).addValue(n.join(f),t).defaultValue(r).execute()},w.setBucket=function(e){return this.bucket=e,this},v.Behavior=r,v.Bucket=i,v.Builder=t,v.FeatureMap=h;var y,b,g,m,B,x={function:!0,object:!0};y=x[typeof window]&&window||this,b=x[typeof exports]&&exports&&!exports.nodeType&&exports,g=x[typeof module]&&module&&!module.nodeType&&module,m=g&&g.exports===b&&b,!(B=x[typeof global]&&global)||B.global!==B&&B.window!==B||(y=B),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(y.Swivel=v,define("Swivel",function(){return v})):b&&g?m?(g.exports=v).Swivel=v:b.Swivel=v:y.Swivel=v}).call(this);
//# sourceMappingURL=swivel.min.js.map