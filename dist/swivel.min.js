/**
 * SwivelJS v0.1.1 - 2015-10-02
 * Strategy driven, segmented feature toggles
 *
 * Copyright (c) 2015 Zumba&reg;
 * Licensed MIT
 */

(function(a){"use strict";Array.prototype.reduce||(Array.prototype.reduce=function(b){if(null===this||this===a)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof b)throw new TypeError(b+" is not a function");var c,d=Object(this),e=d.length>>>0,f=0;if(2===arguments.length)c=arguments[1];else{for(;e>f&&!(f in d);)f++;if(f>=e)throw new TypeError("Reduce of empty array with no initial value");c=d[f++]}for(;e>f;f++)f in d&&(c=b(c,d[f],f,d));return c});var b=".",c=Array.prototype.reduce,d=Object.prototype.toString,e=function(a){return"[object Array]"===d.call(a)},f=function(a,b){this.slug=a,this.strategy=b};f.prototype.execute=function(a){return this.strategy.apply(null,a||[])};var g=function(a,b){this.featureMap=a,this.index=b};g.prototype.enabled=function(a){return this.featureMap.enabled(a.slug,this.index)};var h=function(a,b){this.slug=a,this.bucket=b,this.waived=!1,l.call(this)},i="__swivel_default",j=h.prototype;j.addBehavior=function(a,b,c){var d=this.getBehavior(a,b);return this.bucket.enabled(d)&&l.call(this,d,c),this},j.defaultBehavior=function(a,b){if(this.waived)throw"Defined a default behavior after `noDefault` was called.";return this.behavior||l.call(this,this.getBehavior(a),b),this},j.execute=function(){return(this.behavior||this.getBehavior(null)).execute(this.args||[])},j.getBehavior=function(c,d){return d===a&&(d=c,c=i),"function"!=typeof d&&(d=k(d)),new f(this.slug+b+c,d)},j.noDefault=function(){var a=this.behavior;if(a&&a.slug===i)throw"Called `noDefault` after a default behavior was defined.";return this.waived=!0,this};var k=function(a){return function(){return a}},l=function(a,b){this.behavior=a||null,this.args=b||[]},m=function(a){this.map=r(a)},n=m.prototype;n.add=function(){return new m(c.call(arguments,p,this.map))},n.diff=function(b){var c,d=this.map,e=b.map,f={};for(c in e)!e.hasOwnProperty(c)||d[c]!==a&&d[c]===e[c]||(f[c]=e[c]);for(c in d)d.hasOwnProperty(c)&&e[c]===a&&(f[c]=d[c]);return new m(f)},n.enabled=function(a,c){var d,e=this.map,f="",g=a.split(b),h=g.length,i=0;for(c=1<<c-1;h>i;i++)if(d=g[i],f+=f?b+d:d,!(e[f]&&e[f]&c))return!1;return!0},n.intersect=function(a){var b,c=this.map,d=a.map,e={};for(b in d)d.hasOwnProperty(b)&&c[b]===d[b]&&(e[b]=d[b]);return new m(e)},n.merge=function(){return new m(c.call(arguments,q,this.map))};var o=function(a,b){return a|1<<--b},p=function(a,b){var c,d,e=b.map;for(c in e)e.hasOwnProperty(c)&&(d=e[c],a[c]=a[c]?a[c]|d:d);return a},q=function(a,b){var c,d=b.map;for(c in d)d.hasOwnProperty(c)&&(a[c]=d[c]);return a},r=function(a){var b,c,d={};for(b in a)a.hasOwnProperty(b)&&(c=a[b],d[b]=e(c)?c.reduce(o,0):c);return d},s=function v(a){if(!(this instanceof v))return new v(a);a||(a={});var b=a.map||{},c=b instanceof m?b:new m(b);this.bucket=new g(c,a.bucketIndex)},t=s.prototype;t.forFeature=function(a){return new h(a,this.bucket)},t.invoke=function(a,c,d){var e=a.split(b);return this.forFeature(e.shift()).addBehavior(e.join(b),c).defaultBehavior(d).execute()},t.setBucket=function(a){return this.bucket=a,this},s.Behavior=f,s.Bucket=g,s.Builder=h,s.FeatureMap=m;var u={"function":!0,object:!0};!function(a){var b=u[typeof exports]&&exports&&!exports.nodeType&&exports,c=u[typeof module]&&module&&!module.nodeType&&module,d=c&&c.exports===b&&b,e=u[typeof global]&&global;!e||e.global!==e&&e.window!==e||(a=e),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(a.Swivel=s,define("Swivel",function(){return s})):b&&c?d?(c.exports=s).Swivel=s:b.Swivel=s:a.Swivel=s}(u[typeof window]&&window||this)}).call(this);
//# sourceMappingURL=swivel.min.js.map